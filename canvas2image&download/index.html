<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>下载canvas</title>
</head>
<body>
    <div>
        <canvas width=200 height=200 id="thecanvas"></canvas>
        <button id="downloadImageBtn">Download Image</button>
    </div>

<script>
    function bindButtonEvent(element, type, handler) {
        if(element.addEventListener) {
            element.addEventListener(type, handler, false);
        } else {
            element.attachEvent('on'+type, handler);
        }
    }

    function draw() {
        var canvas = document.getElementById("thecanvas");
        var ctx = canvas.getContext("2d");
        ctx.fillStyle = "rgba(125, 46, 138, 0.5)";
        ctx.fillRect(25,25,100,100);
        ctx.fillStyle = "rgba( 0, 146, 38, 0.5)";
        ctx.fillRect(58, 74, 125, 100);
        ctx.fillStyle = "rgba( 0, 0, 0, 1)"; // black color
        ctx.fillText("Gloomyfish - Demo", 50, 50);
    }

    function saveAsLocalImage () {
        var myCanvas = document.getElementById("thecanvas");
        var image = myCanvas.toDataURL("image/png").replace("image/png", "image/octet-stream");
        window.location.href = image;
    }

    window.onload = function() {

        draw();

        var dlButton = document.getElementById("downloadImageBtn");
        bindButtonEvent(dlButton, "click", saveAsLocalImage);
    };
</script>
</body>
</html>